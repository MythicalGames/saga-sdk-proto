syntax = "proto3";

import "google/protobuf/empty.proto";
import "streams/common.proto";
import "streams/bridge/definition.proto";
import "streams/currency/definition.proto";
import "streams/item/definition.proto";
import "streams/itemtype/definition.proto";
import "streams/listing/definition.proto";
import "streams/myth/definition.proto";
import "streams/offer/definition.proto";
import "streams/order/definition.proto";
import "streams/payment/definition.proto";
import "streams/user/definition.proto";

option java_multiple_files = true;
option java_package = "games.mythical.saga.sdk.proto.streams";

package saga.rpc.streams;

/* Returned results on sending a Status stream call */
message StatusUpdate {
    string trace_id = 1;
    oneof status_update {
        streams.bridge.BridgeUpdate bridge_update = 2;
        streams.currency.CurrencyUpdate currency_update = 3;
        streams.item.ItemUpdate item_update = 4;
        streams.itemtype.ItemTypeUpdate item_type_update = 5;
        streams.listing.ListingUpdate listing_update = 6;
        streams.myth.MythTokenUpdate myth_token_update = 7;
        streams.offer.OfferUpdate offer_update = 8;
        streams.order.OrderUpdate order_update = 9;
        streams.payment.PaymentUpdate payment_update = 10;
        streams.user.UserUpdate user_update = 11;
    }
    int64 created_timestamp = 15;
}

message StatusConfirmRequest {
    string trace_id = 1;
    // @exclude TODO: what else to confirm with?
}

service StatusStream {
    /* Send a call to update the status */
    rpc StatusStream(saga.rpc.streams.Subscribe) returns (stream StatusUpdate);
    /* Get verification of status */
    rpc StatusConfirmation(StatusConfirmRequest) returns (google.protobuf.Empty);
}